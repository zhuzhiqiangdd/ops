# åŸºç¡€æœåŠ¡é…ç½®

## æ–‡æ¡£ä¿¡æ¯
- ç‰ˆæœ¬: v1.0.0
- æ›´æ–°æ—¶é—´: 2024-03-21
- çŠ¶æ€: [ğŸ—ï¸è¿›è¡Œä¸­]
- ä½œè€…: System Admin

## ä¿®è®¢å†å²
| ç‰ˆæœ¬ | æ—¥æœŸ | æè¿° | ä½œè€… |
|-----|------|-----|-----|
| v1.0.0 | 2024-03-21 | åˆå§‹ç‰ˆæœ¬ | System Admin |

## æ–‡æ¡£è¯´æ˜
### ç›®æ ‡è¯»è€…
- ç³»ç»Ÿç®¡ç†å‘˜
- è¿ç»´å·¥ç¨‹å¸ˆ
- ç½‘ç»œå·¥ç¨‹å¸ˆ
- åº”ç”¨å¼€å‘äººå‘˜

### å‰ç½®çŸ¥è¯†
- Linuxç³»ç»ŸåŸºç¡€
- ç½‘ç»œåè®®åŸºç¡€
- æœåŠ¡æ¶æ„åŸºç¡€
- å®‰å…¨åŸºç¡€çŸ¥è¯†

## åŸºç¡€æœåŠ¡æ¦‚è¿°
### å¸¸è§åŸºç¡€æœåŠ¡
1. WebæœåŠ¡
   - Nginx
   - Apache
   - Tomcat

2. æ•°æ®åº“æœåŠ¡
   - MySQL
   - PostgreSQL
   - MongoDB

3. ç¼“å­˜æœåŠ¡
   - Redis
   - Memcached

4. æ¶ˆæ¯é˜Ÿåˆ—
   - RabbitMQ
   - Kafka

5. ä»£ç†æœåŠ¡
   - Nginx Proxy
   - HAProxy
   - Envoy

## WebæœåŠ¡é…ç½®
### Nginxé…ç½®
#### å®‰è£…éƒ¨ç½²
```bash
# Ubuntu/Debian
apt update
apt install nginx

# CentOS/RHEL
yum install epel-release
yum install nginx

# å¯åŠ¨æœåŠ¡
systemctl start nginx
systemctl enable nginx
```

#### åŸºç¡€é…ç½®
```nginx
# /etc/nginx/nginx.conf
user nginx;
worker_processes auto;
error_log /var/log/nginx/error.log warn;
pid /var/run/nginx.pid;

events {
    worker_connections 1024;
    use epoll;
    multi_accept on;
}

http {
    include /etc/nginx/mime.types;
    default_type application/octet-stream;
    
    log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                    '$status $body_bytes_sent "$http_referer" '
                    '"$http_user_agent" "$http_x_forwarded_for"';
    
    access_log /var/log/nginx/access.log main;
    
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    keepalive_timeout 65;
    types_hash_max_size 2048;
    
    include /etc/nginx/conf.d/*.conf;
}
```

#### è™šæ‹Ÿä¸»æœºé…ç½®
```nginx
# /etc/nginx/conf.d/example.conf
server {
    listen 80;
    server_name example.com;
    root /var/www/example;
    
    location / {
        index index.html index.htm;
        try_files $uri $uri/ =404;
    }
    
    error_page 500 502 503 504 /50x.html;
    location = /50x.html {
        root /usr/share/nginx/html;
    }
}
```

#### SSLé…ç½®
```nginx
# SSLé…ç½®ç¤ºä¾‹
server {
    listen 443 ssl;
    server_name example.com;
    
    ssl_certificate /etc/nginx/ssl/example.com.crt;
    ssl_certificate_key /etc/nginx/ssl/example.com.key;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    
    location / {
        root /var/www/example;
        index index.html;
    }
}
```

### Apacheé…ç½®
#### å®‰è£…éƒ¨ç½²
```bash
# Ubuntu/Debian
apt update
apt install apache2

# CentOS/RHEL
yum install httpd

# å¯åŠ¨æœåŠ¡
systemctl start apache2  # Ubuntu/Debian
systemctl start httpd    # CentOS/RHEL
```

#### åŸºç¡€é…ç½®
```apache
# /etc/apache2/apache2.conf æˆ– /etc/httpd/conf/httpd.conf
ServerRoot "/etc/apache2"
Listen 80

# åŠ è½½æ¨¡å—
LoadModule rewrite_module modules/mod_rewrite.so
LoadModule ssl_module modules/mod_ssl.so

# MPMé…ç½®
<IfModule mpm_prefork_module>
    StartServers          5
    MinSpareServers       5
    MaxSpareServers      10
    MaxRequestWorkers    150
    MaxConnectionsPerChild   0
</IfModule>

# è™šæ‹Ÿä¸»æœºé…ç½®
IncludeOptional sites-enabled/*.conf
```

#### è™šæ‹Ÿä¸»æœºé…ç½®
```apache
# /etc/apache2/sites-available/example.conf
<VirtualHost *:80>
    ServerName example.com
    DocumentRoot /var/www/example
    
    <Directory /var/www/example>
        Options Indexes FollowSymLinks
        AllowOverride All
        Require all granted
    </Directory>
    
    ErrorLog ${APACHE_LOG_DIR}/error.log
    CustomLog ${APACHE_LOG_DIR}/access.log combined
</VirtualHost>
```

## æ•°æ®åº“æœåŠ¡é…ç½®
### MySQLé…ç½®
#### å®‰è£…éƒ¨ç½²
```bash
# Ubuntu/Debian
apt update
apt install mysql-server

# CentOS/RHEL
yum install mysql-server

# å¯åŠ¨æœåŠ¡
systemctl start mysql
systemctl enable mysql
```

#### åŸºç¡€é…ç½®
```ini
# /etc/mysql/mysql.conf.d/mysqld.cnf
[mysqld]
# åŸºç¡€é…ç½®
user = mysql
pid-file = /var/run/mysqld/mysqld.pid
socket = /var/run/mysqld/mysqld.sock
port = 3306
basedir = /usr
datadir = /var/lib/mysql
tmpdir = /tmp
bind-address = 127.0.0.1

# å­—ç¬¦é›†é…ç½®
character-set-server = utf8mb4
collation-server = utf8mb4_general_ci

# InnoDBé…ç½®
innodb_buffer_pool_size = 1G
innodb_log_file_size = 256M
innodb_flush_log_at_trx_commit = 1
innodb_flush_method = O_DIRECT
```

#### å®‰å…¨é…ç½®
```bash
# è¿è¡Œå®‰å…¨é…ç½®å‘å¯¼
mysql_secure_installation

# åˆ›å»ºç”¨æˆ·å’Œæˆæƒ
mysql -u root -p
CREATE USER 'username'@'localhost' IDENTIFIED BY 'password';
GRANT ALL PRIVILEGES ON database.* TO 'username'@'localhost';
FLUSH PRIVILEGES;
```

### Redisé…ç½®
#### å®‰è£…éƒ¨ç½²
```bash
# Ubuntu/Debian
apt update
apt install redis-server

# CentOS/RHEL
yum install redis

# å¯åŠ¨æœåŠ¡
systemctl start redis
systemctl enable redis
```

#### åŸºç¡€é…ç½®
```conf
# /etc/redis/redis.conf
# ç½‘ç»œé…ç½®
bind 127.0.0.1
port 6379
protected-mode yes

# å†…å­˜é…ç½®
maxmemory 1gb
maxmemory-policy allkeys-lru

# æŒä¹…åŒ–é…ç½®
save 900 1
save 300 10
save 60 10000
appendonly yes
appendfilename "appendonly.aof"

# å®‰å…¨é…ç½®
requirepass yourpassword
```

## æ¶ˆæ¯é˜Ÿåˆ—é…ç½®
### RabbitMQé…ç½®
#### å®‰è£…éƒ¨ç½²
```bash
# Ubuntu/Debian
apt update
apt install rabbitmq-server

# CentOS/RHEL
yum install rabbitmq-server

# å¯åŠ¨æœåŠ¡
systemctl start rabbitmq-server
systemctl enable rabbitmq-server
```

#### åŸºç¡€é…ç½®
```ini
# /etc/rabbitmq/rabbitmq.conf
# ç›‘å¬é…ç½®
listeners.tcp.default = 5672
management.tcp.port = 15672

# å†…å­˜é™åˆ¶
vm_memory_high_watermark.relative = 0.7

# ç£ç›˜é™åˆ¶
disk_free_limit.absolute = 50MB

# é›†ç¾¤é…ç½®
cluster_formation.peer_discovery_backend = rabbit_peer_discovery_classic_config
cluster_formation.classic_config.nodes.1 = rabbit@node1
cluster_formation.classic_config.nodes.2 = rabbit@node2
```

#### ç”¨æˆ·ç®¡ç†
```bash
# å¯ç”¨ç®¡ç†æ’ä»¶
rabbitmq-plugins enable rabbitmq_management

# åˆ›å»ºç®¡ç†ç”¨æˆ·
rabbitmqctl add_user admin password
rabbitmqctl set_user_tags admin administrator
rabbitmqctl set_permissions -p / admin ".*" ".*" ".*"
```

## ç›‘æ§ä¸ç»´æŠ¤
### æœåŠ¡ç›‘æ§
#### çŠ¶æ€æ£€æŸ¥
```bash
# NginxçŠ¶æ€
systemctl status nginx
nginx -t

# ApacheçŠ¶æ€
systemctl status apache2
apachectl -t

# MySQLçŠ¶æ€
systemctl status mysql
mysqladmin ping

# RedisçŠ¶æ€
systemctl status redis
redis-cli ping
```

#### æ—¥å¿—ç®¡ç†
```bash
# Nginxæ—¥å¿—
tail -f /var/log/nginx/access.log
tail -f /var/log/nginx/error.log

# Apacheæ—¥å¿—
tail -f /var/log/apache2/access.log
tail -f /var/log/apache2/error.log

# MySQLæ—¥å¿—
tail -f /var/log/mysql/error.log

# Redisæ—¥å¿—
tail -f /var/log/redis/redis-server.log
```

### å¤‡ä»½ç­–ç•¥
#### MySQLå¤‡ä»½
```bash
# å®Œæ•´å¤‡ä»½
mysqldump -u root -p --all-databases > backup.sql

# å•åº“å¤‡ä»½
mysqldump -u root -p database_name > database_backup.sql

# å®šæ—¶å¤‡ä»½è„šæœ¬
#!/bin/bash
backup_dir="/backup/mysql"
date_format=$(date +%Y%m%d)
mysqldump -u root -p --all-databases | gzip > $backup_dir/backup_$date_format.sql.gz
```

#### Rediså¤‡ä»½
```bash
# æ‰‹åŠ¨å¤‡ä»½
redis-cli save

# è‡ªåŠ¨å¤‡ä»½é…ç½®
dir /var/lib/redis
dbfilename dump.rdb
save 900 1
save 300 10
save 60 10000
```

## æ€§èƒ½ä¼˜åŒ–
### Nginxä¼˜åŒ–
```nginx
# å·¥ä½œè¿›ç¨‹ä¼˜åŒ–
worker_processes auto;
worker_rlimit_nofile 65535;

# äº‹ä»¶æ¨¡å—ä¼˜åŒ–
events {
    worker_connections 65535;
    use epoll;
    multi_accept on;
}

# HTTPä¼˜åŒ–
http {
    keepalive_timeout 65;
    keepalive_requests 100;
    sendfile on;
    tcp_nopush on;
    tcp_nodelay on;
    
    # ç¼“å†²åŒºä¼˜åŒ–
    client_body_buffer_size 128k;
    client_max_body_size 10m;
    client_header_buffer_size 1k;
    large_client_header_buffers 4 4k;
    
    # Gzipå‹ç¼©
    gzip on;
    gzip_types text/plain text/css application/json application/x-javascript text/xml;
}
```

### MySQLä¼˜åŒ–
```ini
# InnoDBä¼˜åŒ–
innodb_buffer_pool_size = 4G
innodb_log_file_size = 512M
innodb_flush_log_at_trx_commit = 2
innodb_read_io_threads = 8
innodb_write_io_threads = 8

# æŸ¥è¯¢ç¼“å­˜
query_cache_type = 1
query_cache_size = 128M
query_cache_limit = 2M

# è¿æ¥æ•°ä¼˜åŒ–
max_connections = 1000
max_connect_errors = 1000
```

### Redisä¼˜åŒ–
```conf
# å†…å­˜ä¼˜åŒ–
maxmemory 4gb
maxmemory-policy allkeys-lru

# æŒä¹…åŒ–ä¼˜åŒ–
save 900 1
save 300 10
save 60 10000
appendonly yes
appendfsync everysec

# ç½‘ç»œä¼˜åŒ–
tcp-backlog 511
tcp-keepalive 300
```

## å®‰å…¨åŠ å›º
### 1. è®¿é—®æ§åˆ¶
- é…ç½®é˜²ç«å¢™è§„åˆ™
- é™åˆ¶æœåŠ¡è®¿é—®èŒƒå›´
- å®æ–½IPç™½åå•
- å¯ç”¨è®¿é—®è®¤è¯

### 2. åŠ å¯†é€šä¿¡
- é…ç½®SSL/TLS
- ä½¿ç”¨å¼ºåŠ å¯†ç®—æ³•
- å®šæœŸæ›´æ–°è¯ä¹¦
- ç¦ç”¨ä¸å®‰å…¨åè®®

### 3. æƒé™ç®¡ç†
- æœ€å°æƒé™åŸåˆ™
- å®šæœŸå®¡è®¡è´¦å·
- å¯†ç å¤æ‚åº¦è¦æ±‚
- ç¦ç”¨é»˜è®¤è´¦å·

### 4. å®‰å…¨ç›‘æ§
- æ—¥å¿—å®¡è®¡
- å¼‚å¸¸æ£€æµ‹
- å…¥ä¾µæ£€æµ‹
- æ¼æ´æ‰«æ

## æ•…éšœå¤„ç†
### 1. å¸¸è§é—®é¢˜
- æœåŠ¡æ— æ³•å¯åŠ¨
- è¿æ¥è¶…æ—¶
- æ€§èƒ½ä¸‹é™
- ç£ç›˜ç©ºé—´ä¸è¶³

### 2. æ’æŸ¥æ–¹æ³•
- æ£€æŸ¥æ—¥å¿—
- æŸ¥çœ‹ç³»ç»Ÿèµ„æº
- æµ‹è¯•ç½‘ç»œè¿æ¥
- éªŒè¯é…ç½®æ–‡ä»¶

### 3. åº”æ€¥é¢„æ¡ˆ
- æœåŠ¡é™çº§
- å¿«é€Ÿå›æ»š
- å¤‡ä»½æ¢å¤
- åº”æ€¥å“åº”

## æœ€ä½³å®è·µ
### 1. éƒ¨ç½²å»ºè®®
- ç¯å¢ƒéš”ç¦»
- é…ç½®ç‰ˆæœ¬æ§åˆ¶
- è‡ªåŠ¨åŒ–éƒ¨ç½²
- å®¹ç¾å¤‡ä»½

### 2. è¿ç»´å»ºè®®
- ç›‘æ§å‘Šè­¦
- å®šæœŸç»´æŠ¤
- æ€§èƒ½ä¼˜åŒ–
- å®‰å…¨åŠ å›º

### 3. è§„èŒƒå»ºè®®
- é…ç½®è§„èŒƒ
- å‘½åè§„èŒƒ
- éƒ¨ç½²è§„èŒƒ
- æ–‡æ¡£è§„èŒƒ

## å‚è€ƒèµ„æ–™
- [Nginxå®˜æ–¹æ–‡æ¡£](https://nginx.org/en/docs/)
- [Apacheæ–‡æ¡£](https://httpd.apache.org/docs/)
- [MySQLæ–‡æ¡£](https://dev.mysql.com/doc/)
- [Redisæ–‡æ¡£](https://redis.io/documentation)

## ç›¸å…³æ–‡æ¡£
- [ä»£ç†æœåŠ¡éƒ¨ç½²](./02_ä»£ç†æœåŠ¡éƒ¨ç½².md)
- [å®‰å…¨æœåŠ¡å®æ–½](./03_å®‰å…¨æœåŠ¡å®æ–½.md)
